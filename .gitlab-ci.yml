image: golang:1.10
stages:
  - build
  - test
before_script:
  - curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
  - pwd
  - mkdir -p /go/src/github.com/yuichi10/
  - cp -r /builds/yuichi101/matrix /go/src/github.com/yuichi10/
  - cd /go/src/github.com/yuichi10/matrix
  - dep ensure


build-1.8:
  stage: build
  script:
    - go build .
  image: golang:1.8

build:
  stage: build
  script:
    - go build .

golint:
  stage: test
  before_script: 
    - go get -u golang.org/x/lint/golint
  script:
    - golint 
  after_script:
    - ls

test_cover:
  stage: test
  script:
    - go test -cover

test_without_master:
  stage: test
  script:
    - go test -cover 
  except: 
    - master

test_only_master:
  stage: test
  script:
    - go test -cover 
  only: 
    - master
